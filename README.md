# Прогнозирование оттока клиентов для телеком-оператора «ТелеДом»

##  О проекте

Проект по разработке системы прогнозирования оттока клиентов для телекоммуникационной компании «ТелеДом». Модель машинного обучения идентифицирует клиентов, склонных к расторжению договора, что позволяет своевременно предлагать им специальные условия и промокоды для удержания.

##  Цели проекта

- Построение модели прогнозирования оттока с ROC-AUC ≥ 0.85
- Анализ ключевых факторов, влияющих на решение клиента об уходе
- Разработка практических рекомендаций для отдела удержания клиентов
- Создание системы для proactive customer retention

##  Данные

База данных SQLite содержит 4 таблицы с информацией о клиентах:

### Основные таблицы:
- **contract** - информация о договорах (даты, оплата, расходы)
- **personal** - персональные данные клиентов
- **internet** - информация об интернет-услугах  
- **phone** - данные об услугах телефонии

### Ключевые признаки:
- `MonthlyCharges` - ежемесячные расходы
- `TotalCharges` - общие расходы
- `InternetService` - тип интернет-подключения
- `OnlineSecurity`, `TechSupport` - дополнительные услуги
- `Partner`, `Dependents` - семейное положение

##  Технологии

- **Python 3.8+**
- **SQLAlchemy** - работа с базой данных
- **Pandas/NumPy** - обработка и анализ данных
- **Scikit-learn** - машинное обучение и метрики
- **LightGBM** - градиентный бустинг
- **XGBoost** - градиентный бустинг
- **Matplotlib/Seaborn** - визуализация
- **Optuna** - оптимизация гиперпараметров

##  Ключевые этапы работы

### 1. Загрузка и объединение данных
- Подключение к SQLite базе данных
- Объединение 4 таблиц по customerID
- Проверка целостности и согласованности данных
- Создание единого датафрейма для анализа

### 2. Исследовательский анализ и предобработка
- Анализ пропущенных значений и аномалий
- Генерация новых признаков (длительность контракта)
- Визуализация распределения признаков
- Корреляционный анализ
- Преобразование категориальных переменных

### 3. Feature Engineering
- Кодирование категориальных признаков
- Масштабирование числовых переменных
- Создание целевой переменной на основе EndDate
- Балансировка классов при необходимости

### 4. Построение и оптимизация моделей

#### Тестируемые алгоритмы:
- **LightGBM** - градиентный бустинг (лучшая модель)
- **XGBoost** - градиентный бустинг
- **Random Forest** - случайный лес
- **Logistic Regression** - базовая модель

#### Оптимизация гиперпараметров:
- GridSearchCV для подбора оптимальных параметров
- Кросс-валидация для оценки устойчивости моделей
- Балансировка precision и recall

### 5. Оценка и тестирование
- Разделение на train/test (75/25)
- Оценка по метрикам: ROC-AUC, Accuracy, Precision, Recall
- Построение матрицы ошибок
- Анализ важности признаков

##  Результаты

### Сравнение моделей:

| Модель | ROC-AUC | Precision | Recall | Accuracy |
|--------|---------|-----------|--------|----------|
| **LightGBM** | **0.8947** | 0.8434 | 0.5700 | 0.8472 |
| XGBoost | 0.8951 | 0.8300 | 0.5600 | 0.8421 |
| Random Forest | 0.8200 | 0.7800 | 0.4500 | 0.8100 |

### Ключевые достижения:
- ✅ **Цель достигнута**: ROC-AUC = 0.8947 > 0.85
- ✅ **Высокая точность**: Precision = 0.8434
- ✅ **Практическая применимость**: Готовность к внедрению

##  Анализ результатов

### Ключевые факторы оттока:
1. **Финансовые показатели**:
   - Высокие MonthlyCharges (>$35)
   - Низкие TotalCharges (новые клиенты)

2. **Демографические факторы**:
   - Отсутствие семьи (Partner='No', Dependents='No')
   - Молодые клиенты (SeniorCitizen='No')

3. **Услуги и сервисы**:
   - Отсутствие OnlineSecurity и TechSupport
   - Тип подключения Fiber optic

### Бизнес-инсайты:
- **Группы риска**: Клиенты с платежами >$35 и новички
- **Услуги-якоря**: OnlineSecurity и TechSupport снижают отток на 30%
- **Сезонность**: Пики оттока после 6 месяцев обслуживания
